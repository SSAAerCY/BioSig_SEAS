import numpy as np


list_d = [5, 47, 48, 49, 51, 56, 57, 66, 100,101,102,105,269]



list_d = [5,6,7,10, 50, 100, 101, 102, 777, 778, 1000]


list_d = [5,5,6,6,9,100,10000,10001,10005]


ref = [0.0085034780379213727, 0.0084883418821669089, 0.0084870246890482812, 0.008491006927238717, 0.0084803970076223357, 0.0084911424685021244, 0.0085097701148349712, 0.0084962898194232486, 0.0085029750814353908, 0.0085196911559856803, 0.0085093724614780392, 0.008522168008284519, 0.008521624953909044, 0.0085301237334274634, 0.0085254416098023995, 0.0085081381076322644, 0.0084954225855582589, 0.0085094614032011386, 0.0085022962461405397, 0.0085060441924205629, 0.0084941534249805915, 0.0084995885513801297, 0.0084961695049824686, 0.0084964522656048348, 0.0085172783834118696, 0.0085050498137330226, 0.0085213313765315612, 0.0085155980357039807, 0.0085110350789401375, 0.0085192365820038543, 0.008511489509730033, 0.0085075120450344311, 0.008500256233184041, 0.0085057401566358808, 0.0085121536990259272, 0.0085117903272253891, 0.0084972932109949016, 0.0085093487740073928, 0.0084788352652496422, 0.0085026575486102964, 0.0084842649937766895, 0.0084922749013861699, 0.0085103827589846845, 0.0084981273354565994, 0.0084909188223306238, 0.0085047806052976713, 0.0085031363884083434, 0.0084834606602237177, 0.0084937319600845492, 0.0084957431591484913, 0.0085121761848532158, 0.0085023583140439504, 0.0084978658926379499, 0.008486948778785244, 0.0084948158557363214, 0.0085043718529873268, 0.0085122875648186713, 0.0085132693190010083, 0.0085110015974273982, 0.0085028916989445189, 0.0084914180271242722, 0.0085065585950195206, 0.0084972764671204012, 0.0085116877470796312, 0.0085153983306677384, 0.0085007701873370152, 0.0084790405991867542, 0.0085058711643325475, 0.0084888189119104208, 0.0084891860198393031, 0.0084801993620950422, 0.0084949945709636571, 0.0084864377497536631, 0.008475920743856934, 0.0084750724672564681, 0.0084793651490530312, 0.0084784813980570504, 0.008470672443960478, 0.0084761815680989509, 0.008464831216921995, 0.0084779325291206662, 0.0084996072437709298, 0.0085045786970483067, 0.0084945005829115457, 0.0084968342287473925, 0.0084985203631610245, 0.0084669509879155488, 0.0084838071315970157, 0.0084801842318842618, 0.0084910594953590702, 0.0084851521037299909, 0.0084893895707002735, 0.0084935327164382037, 0.0084911322251174856, 0.0084930181237567841, 0.008498921085087742, 0.0084747146011004831, 0.0085131306644403854, 0.0084810418246665572, 0.0085076090649345328, 0.0084904746883885801, 0.0084922895078782309, 0.0084811596512314215, 0.0084941046810491881, 0.0084931787706460302, 0.0084969434213111022, 0.0084797765561036957, 0.0084749693924570969, 0.0084951319656847903, 0.00851379502415185, 0.0084776664003174927, 0.0085164746702575591, 0.0084943710903818068, 0.0084797882551053052, 0.0085065818810489673, 0.0085360257762798538, 0.0085527105331780397, 0.0085439470146215883, 0.0085928411242655583, 0.0085545178573418184, 0.0085454081714232879, 0.0085687682026856001, 0.0085633641309085309, 0.0085604708330485058, 0.0085707606378206177, 0.0085629187521035471, 0.0085425818335462308, 0.0085633002699073632, 0.0085609347884086813, 0.0085319115668939308, 0.0085657512457691619, 0.0085678397550699691, 0.0085221274476718553, 0.0085461802362569034, 0.0085512210874355218, 0.0085604267678850883, 0.0085446637108902851, 0.0085763418459772547, 0.008559344627912897, 0.008524064608040045, 0.0085404044136550943, 0.008541546877602323, 0.0084960074255001003, 0.0085327305922963618, 0.0085192726859187884, 0.0085215931587456911, 0.0085026747846479386, 0.0084849573020111136, 0.0084880985434665733, 0.0085131042117820594, 0.0084798070109220382, 0.0085420302795419702, 0.0085242217780982215, 0.0085131042705912808, 0.0085088573057279706, 0.0084799397234807013, 0.0085049435133193428, 0.0084678702710501447, 0.0084580981287097554, 0.00847279276896995, 0.0084807248574602506, 0.0084789166889148136, 0.0084593303453796617, 0.0084844481604959936, 0.0084524405557866774, 0.0084508874020498888, 0.0084682349632971797, 0.0085140972452048026, 0.0084680477178296389, 0.0084714124504800987, 0.0084602111584326546, 0.008447872135740107, 0.0084870207840525864, 0.008422041522925923, 0.008487283814021012, 0.0084693007495693848, 0.0084805419483306149, 0.0084440974235956649, 0.0084533881066578033, 0.0084557974669232112, 0.0084271648684388148, 0.0084884602285139645, 0.0084780085680040505, 0.0085339286238312276, 0.0084677499107353484, 0.0085092340870075948, 0.0084721730618613402, 0.0084976299735831928, 0.0084984968605278828, 0.0084874622051367612, 0.0084910683844008957, 0.0084862129638158951, 0.008469030209797692, 0.0084759678532410534, 0.0084925366984911401, 0.0085110541616545462, 0.0084777447308488647, 0.0083808669371333629, 0.0085427105791029377, 0.0084236515335026473, 0.0085132809012908855, 0.0084417632332934207, 0.0085818840829754474, 0.0084830724883606465, 0.0084688952073635679, 0.0085078718782323932, 0.0084250409957910433, 0.0084437510302078234, 0.0084213691931302494, 0.0084442410631854238, 0.0084245104276164245, 0.0084437436017280112, 0.0084770037867616319, 0.0084044220668570736, 0.0084199523055160704, 0.0084896345077366195, 0.0084594450848973039, 0.0084713908171902327, 0.0084438480484058578, 0.0084616597788828626, 0.0084149045692423156, 0.0084283972852759216, 0.0084708619268633635, 0.0085389554271239117, 0.00848477996300891, 0.0084097341220330194, 0.0085330635837259552, 0.0084576629810189791, 0.0084928282638781095, 0.0085197809741578163, 0.0085889471003685464, 0.008530538694858824, 0.0084155287637884234, 0.0084050879112732933, 0.0084400191373025513, 0.0084359238994559677, 0.0084204059716955163, 0.0084315548636071866, 0.0084795777101273756, 0.0084014303976534619, 0.0084126405202454221, 0.0085647455295439715, 0.0084739832349731269, 0.0085559400727885163, 0.0084122108171193963, 0.0084735762374813974, 0.0084729267955033476, 0.0085125456607450124, 0.0084472428376201475, 0.0083469622077687877, 0.0084774214956795484, 0.0084546857509562399, 0.0084736868911871668, 0.0084529260151555187, 0.0085332617408043938, 0.0084106316734610838, 0.0085490359081122434, 0.0086270672529873034, 0.0085185380427042403, 0.0085427195897466741, 0.008437417216356248, 0.0084528605715679574, 0.0085483840383139276, 0.0084930391303299387, 0.0084317640296698235, 0.0085151312800244589, 0.0085391536611966051, 0.0083870029990557263, 0.0085019103925021346, 0.0084337898575917985, 0.0085165304272163365, 0.0085379484637597633, 0.0085621782659662336, 0.008489080494160809, 0.0084576206440344186, 0.0084061846404315139, 0.0085758605251947482, 0.0084760766524788443, 0.0087866523678726532, 0.0085423470768336961, 0.0083159222847890065, 0.0083062168868272626, 0.0085087163189363334, 0.008322769800095409, 0.0085809014628330724, 0.0087434618682619408, 0.0085577324929077131, 0.0084364994672381233, 0.008530629271135317, 0.0084985403631512996, 0.0085087730838927216, 0.0084807583191494635, 0.0084210136612496312, 0.0084635993371650464, 0.0085743766085073156, 0.0086792132653089049, 0.0084964133941038706, 0.0089321513936993918, 0.0086003183833937291, 0.0086386547561884842, 0.0084532456406829128, 0.0084999616110493954, 0.0086208705067717557, 0.0083448109618846165, 0.0084738866395079396, 0.0082525179214638089, 0.0085472692539106318, 0.0080582650429709898, 0.0083659596704001946, 0.0083079701039444915, 0.0086288088276744602, 0.0085776117249422822, 0.0085916256725223055, 0.0081055634406909643, 0.0089077488935952846, 0.0083275256149615406, 0.0084950501162946827, 0.008076040014889093, 0.0082904385098268567, 0.0084194043774876385, 0.0081390631184428738, 0.0086676017595931389, 0.0084951848937558777, 0.0083941328060306158, 0.0082567382713885622, 0.0084944017983349419, 0.0080351492720403383, 0.0083241852018935882, 0.0083529296437779878, 0.0086963951081609932, 0.009064991386832132, 0.0083980551077954754, 0.0084089355439842875, 0.0084151548319287145, 0.0082500418375738779, 0.0081833313638315034, 0.0086120652270241932, 0.0084828067391363327, 0.0079721609138811728, 0.008155524267311488, 0.0084871339901272155, 0.0081140123423540031, 0.0084487440063322206, 0.0079513562988392898, 0.0086914896248691843, 0.0086514592728017901, 0.0076482571073790851, 0.0084423349765305866, 0.0082267345796580398, 0.0093024858849785584, 0.0088801616154050543, 0.0090653165085130775, 0.0087015445043224383, 0.0081432460651386009, 0.0083735234733059508, 0.0091636144862006219, 0.0087212589777460083, 0.0091852333941850797, 0.0087166485700696534, 0.0082053062887024238, 0.0082662198879739149, 0.0087139987195147713, 0.0073573286556451543, 0.0082358491131001316, 0.0090724165924014142, 0.0087061887893121886, 0.0094340903455248058, 0.0093177847837145611, 0.0089553925696101086, 0.0086628482135314832]
bio = [0.0084846082069845608, 0.0085006804276366085, 0.0085230179552418274, 0.0085182898695501004, 0.0084947328830194697, 0.0085006396868348225, 0.0085001125342348393, 0.0085017558708636448, 0.0085045929837462599, 0.0085051480757238358, 0.0085140673142725196, 0.0085113704474074209, 0.0085169783234892993, 0.0085174272984955245, 0.0085160787058450125, 0.0085167808180223736, 0.0085262970353326677, 0.0085230164537321226, 0.0085251389435527097, 0.0085201354284982645, 0.008518493105854107, 0.0085058740793945379, 0.0085092616397816571, 0.0085115255383298605, 0.0085142343335837898, 0.0085170678872761967, 0.008513741398676701, 0.0085163551978594491, 0.0085116967819745867, 0.0085169582325934391, 0.0085109882011992505, 0.0085026891301591793, 0.0085072930444484978, 0.0085062830747610427, 0.0085129139750267091, 0.0085115069518490131, 0.0085143277224942488, 0.0085267745483527564, 0.0085279045467247915, 0.0085252843645670928, 0.0085241754732953475, 0.0085296294239470358, 0.0085270487432222188, 0.0085175010607687583, 0.0085115580170990884, 0.0085121425506304305, 0.0085086518160527903, 0.0085099520520657279, 0.0085075262902046776, 0.0085079497155633003, 0.0085104150491232752, 0.0085062179565529809, 0.008499615809077642, 0.0084982877280494421, 0.0085016540129543745, 0.0085028204707273732, 0.008516082198475404, 0.0085146589058968415, 0.0085024180061655779, 0.0084994734270978124, 0.0084970480259825044, 0.0084960177032079968, 0.0085002097289767799, 0.0085004391581935609, 0.0084967277266758609, 0.0084927685578359488, 0.0084937388031457173, 0.0084941094772108469, 0.0084912149832150428, 0.0084859101886087702, 0.0084850787741943007, 0.0084866825496880665, 0.0084852446074825741, 0.0084838478472257228, 0.0084840411933274074, 0.0084794058335063028, 0.0084755538267562488, 0.0084777333225201663, 0.0084766737988960922, 0.0084766787772045608, 0.0084798403588886122, 0.0084830299251619674, 0.0084862237492298442, 0.0084875732097904246, 0.0084860661639529159, 0.0084813593524981686, 0.0084785853725374161, 0.0084793055223417284, 0.008484205796771175, 0.0084859925564804983, 0.0084843753877700805, 0.0084831230749624446, 0.0084870567963428803, 0.0084922041628427963, 0.0084922262645456877, 0.0084897983455859208, 0.0084920940288355107, 0.0084960449424187658, 0.0084979646051637839, 0.0084997785724894876, 0.0085032378092964028, 0.0085087834863237562, 0.0085112198245545657, 0.008513359541218922, 0.0085156635296086032, 0.0085181638250894382, 0.0085224375591995815, 0.0085258302974127939, 0.008526025552153909, 0.0085252320741113861, 0.0085209188175362164, 0.0085196234570783635, 0.0085163143494309517, 0.0085190029372547698, 0.0085277297233927185, 0.0085408131715613254, 0.0085507641569002764, 0.0085533049745199936, 0.0085546961442185595, 0.0085575418762677859, 0.0085584183872580641, 0.0085622549218887043, 0.008557232676488228, 0.008554645541589757, 0.00855650294206446, 0.008555561002826945, 0.0085604442575890494, 0.0085603633569389329, 0.0085559440947102806, 0.0085569577493398406, 0.0085575617617975781, 0.0085579728824161511, 0.0085592130965680517, 0.00856035099907047, 0.0085598403471961303, 0.0085580082868070388, 0.0085578675055000119, 0.0085553717073006529, 0.008554555338130241, 0.0085546495577335808, 0.0085560041102728732, 0.0085569928955301303, 0.008558600637747606, 0.008558252884369618, 0.0085576653313093852, 0.0085586364439747611, 0.0085572408833107308, 0.0085564872363306892, 0.00855685327946221, 0.0085571837270009138, 0.0085570333969295451, 0.0085573755089887286, 0.0085575139572956482, 0.0085583532674809847, 0.0085588653656812879, 0.0085592322597100468, 0.0085593635239386741, 0.0085591147697972082, 0.0085582218556618413, 0.0085570677971718596, 0.0085565143487887161, 0.008556823696507683, 0.008557810021935227, 0.008558616921373061, 0.008558931871105355, 0.0085590157903318378, 0.008558515503463416, 0.0085573512994230432, 0.008556094805412506, 0.0085550936339365401, 0.0085543101344391168, 0.0085536652454923506, 0.0085530506046875253, 0.0085526769474483406, 0.0085523013508294228, 0.008551905979878963, 0.0085514658146076949, 0.0085508914027609632, 0.008550398442659226, 0.0085496588119812686, 0.0085489635807021649, 0.008548194033039011, 0.0085474549533147582, 0.0085466660968130971, 0.0085458351765739515, 0.0085449597733058998, 0.0085440375652321709, 0.0085430723294821972, 0.0085420565019574089, 0.0085409854144490992, 0.0085398522444350318, 0.0085386559469515302, 0.008537405650688357, 0.0085361134518373433, 0.0085347823138389976, 0.0085334286282187036, 0.0085320701944082665, 0.0085308834483020114, 0.0085297367197387838, 0.0085284752120285551, 0.0085272750972215997, 0.0085263019975387998, 0.0085253895728716576, 0.0085244240215898662, 0.0085235480991717842, 0.0085228146449389652, 0.0085220448080796166, 0.008521201755130792, 0.0085202364619974477, 0.0085189430261169395, 0.0085175991615408942, 0.0085161257828526189, 0.0085147135397478455, 0.0085134454573627897, 0.0085122954282121268, 0.0085112854763510874, 0.0085104497505671881, 0.008509967546162912, 0.0085096823136112283, 0.0085094895121442318, 0.0085093782661334588, 0.0085093593497416985, 0.0085094656409702846, 0.0085095665727550601, 0.0085095581682832089, 0.0085093519296245076, 0.0085089807756579625, 0.0085082583006269186, 0.0085071703114653965, 0.0085058841831979464, 0.0085040627407425764, 0.0085017766367397173, 0.0084990369726466331, 0.0084952899992672137, 0.008491059434306782, 0.0084875016437322929, 0.0084843725218303693, 0.0084808551386211239, 0.0084768070321651744, 0.0084731552828362627, 0.0084702242422975502, 0.0084673962292964224, 0.0084652292052794353, 0.0084645299999608053, 0.0084627078748345051, 0.0084610378669267624, 0.0084623259144416246, 0.0084638703699169721, 0.0084649744609735702, 0.0084665526003254079, 0.0084686204250178625, 0.0084680035447825455, 0.0084673298869977851, 0.0084674053344694095, 0.0084669612066002407, 0.0084652519217862047, 0.0084644465371324501, 0.0084664103366534956, 0.0084669410968232061, 0.0084672973993269087, 0.0084684314261187169, 0.0084696407871809772, 0.0084703293226524659, 0.0084720288593899806, 0.0084739735134748955, 0.0084750573946768999, 0.0084748327917757507, 0.0084749072331649078, 0.0084757133330389048, 0.0084777941117149414, 0.008481346817776696, 0.0084839190093117731, 0.0084863681197001745, 0.0084882563117499258, 0.0084901676031629448, 0.0084919646327754061, 0.0084935180330753621, 0.0084943230235518495, 0.0084952291248975974, 0.0084973714219372977, 0.0084983213712935806, 0.0084975998506752262, 0.008496467162960453, 0.008495359723099654, 0.0084946212360085885, 0.0084945201455919571, 0.0084953691662035865, 0.0084963101545261419, 0.0084964325872199323, 0.0084952043405577219, 0.0084942667523978908, 0.0084971594174217489, 0.0084994390002339614, 0.0085011894126050518, 0.0085030468707599401, 0.0085041007983922556, 0.008506461432979423, 0.008507608229959723, 0.0085084133835215923, 0.0085089173258089679, 0.0085092968562859965, 0.008509342001766099, 0.0085086395570417826, 0.0085082976644976684, 0.0085078028899286898, 0.0085082991426622626, 0.0085088135502960332, 0.0085079219449671825, 0.0085069552075360821, 0.0085101183507730604, 0.0085114410275162981, 0.0085146751121142148, 0.0085143256791573637, 0.0085140016394866444, 0.0085148482749281343, 0.0085155103174735444, 0.0085160178939135949, 0.0085189004288948704, 0.0085186283125395536, 0.0085184432406131619, 0.0085163677239009812, 0.0085162320827746191, 0.0085160261789557455, 0.0085136726336743768, 0.0085138532631117113, 0.0085154145284981071, 0.0085153126060329536, 0.0085146065324883703, 0.0085149971039857955, 0.008512019257938647, 0.0085134497853633258, 0.008515019721252088, 0.0085161733446537588, 0.0085151037561791675, 0.0085164323762520477, 0.0085159070447478075, 0.0085184103178438803, 0.0085213132933413139, 0.0085229452481041731, 0.0085248214895889268, 0.0085261836356968941, 0.0085257088183920016, 0.008527482913813722, 0.0085271427419848968, 0.0085272519687155483, 0.0085270390636232804, 0.0085284156940081939, 0.0085286069327260329, 0.0085298896394656494, 0.0085297317999803168, 0.0085297030936594721, 0.008526146266483214, 0.0085268674803479407, 0.0085259062323491605, 0.0085280292463573906, 0.0085281535469544593, 0.008528696671582273, 0.0085285476234877779, 0.0085295373543157263, 0.0085296366194779621, 0.0085308798221080898, 0.0085308161055972463, 0.0085310337457950719, 0.0085322507773851787, 0.008536056438678833, 0.0085392988937169814, 0.0085407467982433274, 0.0085430918606255214, 0.0085431933706240949, 0.0085433671328174633]
error = [5.598977563982765e-06, 4.8560569155381781e-06, 4.5957673350918572e-06, 4.4194108527221282e-06, 4.340307822421545e-06, 4.3345848209715353e-06, 4.346087706565319e-06, 4.3551671385899282e-06, 4.389286557070335e-06, 4.4600833114491621e-06, 4.5410451990810843e-06, 4.6245040889464779e-06, 4.701735644259649e-06, 4.7605903644240467e-06, 4.8094842757094512e-06, 4.8720769742176197e-06, 4.9543966566683786e-06, 5.0404824989428105e-06, 5.1128111395836881e-06, 5.1853110064596514e-06, 5.265127923260103e-06, 5.3440391539477418e-06, 5.4178396492747429e-06, 5.4920263284363938e-06, 5.5671876651425983e-06, 5.6488241121960596e-06, 5.7464962517878016e-06, 5.8496832679154068e-06, 5.9422215153496703e-06, 6.0281981824528709e-06, 6.1224138055340873e-06, 6.2241655355819918e-06, 6.3212320181104248e-06, 6.4066239218870185e-06, 6.4958298674588731e-06, 6.5994319070170936e-06, 6.7090927965016159e-06, 6.8078911223915582e-06, 6.8927282528969737e-06, 6.9764457441741777e-06, 7.0642594890531134e-06, 7.1574566810736423e-06, 7.2533237116858381e-06, 7.3414486087797521e-06, 7.4187822032674887e-06, 7.4963369705995644e-06, 7.5755093851827323e-06, 7.6533400343790255e-06, 7.7354968677129854e-06, 7.8258268204526671e-06, 7.9183191293277911e-06, 8.0072830456262739e-06, 8.0898220113656814e-06, 8.1603333019885036e-06, 8.2196421671514912e-06, 8.2777426760046983e-06, 8.3423135947587888e-06, 8.4133552415347348e-06, 8.4885266073751337e-06, 8.5584600284243014e-06, 8.6159348202160024e-06, 8.6715012228338983e-06, 8.7327371618537015e-06, 8.7980571626755155e-06, 8.8672096521615303e-06, 8.9389022920943234e-06, 9.0124245983434091e-06, 9.0920413391291603e-06, 9.1849466919261374e-06, 9.2866548307528651e-06, 9.3799913140539319e-06, 9.4567053161916503e-06, 9.5254064099882479e-06, 9.599000883239517e-06, 9.6801526506645753e-06, 9.7647335335294179e-06, 9.8512491023612166e-06, 9.9388959205051343e-06, 1.0026523424880004e-05, 1.0113639215538148e-05, 1.0201848210557014e-05, 1.0291796252208865e-05, 1.0379520215716634e-05, 1.0465009787772042e-05, 1.0555563392559528e-05, 1.0654892133115895e-05, 1.0757413131479261e-05, 1.0854288656229478e-05, 1.0944864842235179e-05, 1.1036614786813306e-05, 1.1132993159014467e-05, 1.1232255489234771e-05, 1.1333341242042024e-05, 1.1436660901043992e-05, 1.154272703996916e-05, 1.1648930610220939e-05, 1.1750997950073206e-05, 1.1849897166216961e-05, 1.1951187824217928e-05, 1.2058760229841776e-05, 1.2172202786954881e-05, 1.2287575594968877e-05, 1.2402937938262798e-05, 1.2520713810452812e-05, 1.2642706533303655e-05, 1.2767289058000172e-05, 1.2891722219805018e-05, 1.3014248023209839e-05, 1.3136378152671153e-05, 1.3260893819881812e-05, 1.3387324668170496e-05, 1.3516278966402752e-05, 1.3650372821675797e-05, 1.3787893523557017e-05, 1.3924894299405672e-05, 1.4061629228329622e-05, 1.4203067912088734e-05, 1.4352360534225676e-05, 1.450343323938662e-05, 1.4642423492188494e-05, 1.476393347968509e-05, 1.487657697128757e-05, 1.4989766946946338e-05, 1.5106037557840509e-05, 1.5223763506702685e-05, 1.5339892353125424e-05, 1.5455498654537723e-05, 1.5576205887950472e-05, 1.5704651706942251e-05, 1.5834954573239329e-05, 1.5958134907595381e-05, 1.6074544087385411e-05, 1.6196517248623696e-05, 1.6333373695715039e-05, 1.6478987902751439e-05, 1.6624778522641745e-05, 1.6780077542382466e-05, 1.6961150381314967e-05, 1.7156153791223083e-05, 1.7324907589778799e-05, 1.7442664889708205e-05, 1.7526342661187485e-05, 1.7614868220403803e-05, 1.7737350360395176e-05, 1.7898746091527745e-05, 1.8083732527654291e-05, 1.8277006515942846e-05, 1.8479170417878032e-05, 1.8697801875117848e-05, 1.892797231523851e-05, 1.9152931567514503e-05, 1.9361299826684337e-05, 1.9559340452787968e-05, 1.9764099853211416e-05, 1.9985024646737182e-05, 2.0218719097353395e-05, 2.045967436787543e-05, 2.0709995877640659e-05, 2.0979786561711038e-05, 2.1278562190146614e-05, 2.1596539219197784e-05, 2.190153176028452e-05, 2.2172466596855897e-05, 2.2426507268214299e-05, 2.2693190838945528e-05, 2.2977531947169697e-05, 2.3270110797435275e-05, 2.3577702841322975e-05, 2.3918989835691572e-05, 2.4294440563240767e-05, 2.4679293508293491e-05, 2.5048775516919886e-05, 2.539986622040266e-05, 2.5745935453080101e-05, 2.6100375302347652e-05, 2.6469020014616971e-05, 2.6851971198344342e-05, 2.7248069512296199e-05, 2.7657638110002602e-05, 2.8077135809941681e-05, 2.8491242186963655e-05, 2.8879718262926938e-05, 2.9240569833389816e-05, 2.9597434049947566e-05, 2.9977155471304777e-05, 3.0389903396815722e-05, 3.0834891731564048e-05, 3.1309673926908455e-05, 3.1803670886146204e-05, 3.2295816493701096e-05, 3.2769379929561313e-05, 3.3222157573279309e-05, 3.365854958571092e-05, 3.4079708701500503e-05, 3.4486325389692826e-05, 3.4886424127139196e-05, 3.5294752855807573e-05, 3.5721895792466225e-05, 3.6165000284167435e-05, 3.6614048955928496e-05, 3.706613649280761e-05, 3.7527910948492787e-05, 3.8006928323270355e-05, 3.850553522207018e-05, 3.901517864862281e-05, 3.9509469960510195e-05, 3.9957020437801181e-05, 4.0354780701362092e-05, 4.0739653572194558e-05, 4.1155364469930786e-05, 4.1614352904362219e-05, 4.209789247601214e-05, 4.2588836598394496e-05, 4.3096856306870459e-05, 4.364919613766272e-05, 4.425443813123723e-05, 4.4876131470150252e-05, 4.5454369231018138e-05, 4.5962226412034057e-05, 4.6437528945854161e-05, 4.6948516229639187e-05, 4.753181877800292e-05, 4.8169250144104756e-05, 4.8816262528412842e-05, 4.9441066037942513e-05, 5.0042057781083554e-05, 5.0647390514940485e-05, 5.1301819893408546e-05, 5.2034413128564382e-05, 5.2824459063271088e-05, 5.3610955279823896e-05, 5.4358027409584446e-05, 5.5111520934460358e-05, 5.5969815881255052e-05, 5.6980794604354517e-05, 5.8062672447100513e-05, 5.9040091549641556e-05, 5.9789403186618701e-05, 6.0358622682328883e-05, 6.0926144970361479e-05, 6.1645100085788002e-05, 6.2542057487290697e-05, 6.3546957323411805e-05, 6.4585984951805736e-05, 6.5634081232435616e-05, 6.6701614613422924e-05, 6.7800682751533581e-05, 6.8931857690135258e-05, 7.0100531951608667e-05, 7.13404476210616e-05, 7.2695004221761823e-05, 7.4142104743312855e-05, 7.5546297771088587e-05, 7.6744253319437972e-05, 7.7708920686325365e-05, 7.8593322944722299e-05, 7.9588902244827662e-05, 8.0780843351521074e-05, 8.2158817063330753e-05, 8.371510273649674e-05, 8.5460529181686384e-05, 8.7327451732697621e-05, 8.9109892801341771e-05, 9.0567101679860958e-05, 9.1612661048581451e-05, 9.2382622797100984e-05, 9.3119938345956668e-05, 9.4023586604956535e-05, 9.5193875515231028e-05, 9.6654180971441337e-05, 9.836830231424634e-05, 0.0001002568709591423, 0.00010224024814100241, 0.00010428503984332934, 0.00010639935176551081, 0.00010857593272687775, 0.00011075008165609316, 0.00011282754295446413, 0.00011476197231635767, 0.00011661116300059761, 0.00011852093581581362, 0.0001206476227397528, 0.0001230704075212045, 0.00012574291070030158, 0.00012851611133435316, 0.00013122248614712951, 0.00013376609564890129, 0.00013616048173900722, 0.00013849880732922973, 0.00014089327019144377, 0.0001434248661829821, 0.00014612489686283451, 0.00014898236115622142, 0.00015196439687840518, 0.00015503268827132146, 0.00015815646049850411, 0.0001613254588074585, 0.00016455876351697374, 0.00016789619007836343, 0.00017138009493709245, 0.00017504856401275219, 0.00017894751599041049, 0.00018311584205238488, 0.00018751785951988032, 0.00019198189084467597, 0.00019625537327688496, 0.00020017189332735053, 0.00020377751813990957, 0.00020727790550891325, 0.00021087501911060152, 0.0002146534984146275, 0.00021859898010854881, 0.00022266342359253191, 0.00022679977195367722, 0.00023096762917224607, 0.00023514361917938395, 0.00023935292180101431, 0.00024367982572867609, 0.00024823432589865394, 0.00025308466533763806, 0.00025821414754772772, 0.00026353660925145233, 0.00026896529046750776, 0.00027445599499306082, 0.00027998910117543188, 0.00028551636474729908, 0.00029093847491162286, 0.0002961540367906091, 0.00030113247586563831, 0.00030595311078041514, 0.00031077241063287299, 0.00031574239834684633, 0.00032092869357975022, 0.00032630368041255134, 0.00033183205621546843, 0.00033755364248395469, 0.00034357219258820975, 0.00034995153619561952, 0.00035662013821580126, 0.00036339802542947728, 0.00037015299742438327, 0.00037694508875875008, 0.00038402153571863668, 0.00039162062135483468, 0.00039974804466755715, 0.00040810088097300429, 0.00041622412379372346, 0.00042390702158988559, 0.00043096903969791543, 0.00043767501655402085, 0.00044446118286218926, 0.00045162793463761445, 0.00045918681885170161, 0.00046702835747592042, 0.00047522795970409484, 0.00048404525068121109, 0.00049356848790434616, 0.00050353018708204742, 0.00051366859572021958, 0.00052415388886409287, 0.00053530160289797662, 0.00054695665459239973, 0.00055892410292109182, 0.00057248860947648101, 0.0005905647290564603, 0.00061472021756996218, 0.00064167775568723805, 0.00066576955715736351, 0.00069020627660436058, 0.00055757350912578646]
list_d = [2, 3, 16, 38, 39, 40, 41, 42, 107, 146, 149, 151, 152, 153, 154, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 168, 169, 172, 176, 178, 179, 184, 191, 276]


def merge_list(list_d, ref,bio,error,param=5):
    
    new_list = []
    compare_list = []
    tag = []
    prev = -100
    begin = True
    
    if list_d == []:
        return []
    elif len(list_d) == 1:
        return list_d
    else:
        pass
    
    for i in list_d:
        
        if begin:
            begin = False
            prev = i
            continue
    
        compare_list.append(abs(i-prev) <= param)
        prev = i
    
 
    
    for j,id in enumerate(compare_list):
    
        if id == True:
            if tag == []:
                tag.append(list_d[j])
                tag.append(list_d[j+1])
            else:
                tag.append(list_d[j+1])
        
        else:
            try:
                value = tag[0]+(tag[-1]-tag[0])/2
                
                y1 = np.array(map(ref.__getitem__, tag))
                y2 = np.array(map(bio.__getitem__, tag))
                error = np.array(map(error.__getitem__, tag))
                
                max_value, max_index = max([(v,i) for i,v in enumerate((y2-y1)/error)])
                
                new_list.append(tag[max_index])
            except:
                new_list.append(list_d[j])
            tag = []
    
    if tag != []:
        new_list.append(tag[0]+(tag[-1]-tag[0])/2)
    
    if compare_list[-1] == False:
        new_list.append(list_d[-1])

        
    
    return new_list

right = merge_list(list_d,ref,bio,error)


y1 = np.array(map(ref.__getitem__, right))
y2 = np.array(map(bio.__getitem__, right))
errors = np.array(map(error.__getitem__, right))

print (y2-y1)/errors

